from ultralytics import YOLO

# Load a model, set data, and train
model = YOLO("yolov8x.pt")         
model.train(
    data="data.yaml",
    epochs=80,            
    patience=20,         
    imgsz=960,
    batch=8,
    augment=True,        
    shear=10.0,
    lr0=0.002,            
    lrf=0.1,             
    project="runs/train",
    name="hexbug_v8x",
    device=[0,1,2,3]
)
model = YOLO("yolov8s.pt") 
model.train(
    data="data.yaml",
    epochs=50,            
    patience=10,         
    imgsz=640,
    batch=16,
    augment=True,
    lr0=0.005,            
    lrf=0.2,             
    project="runs/train",
    name="hexbug_v8s",
    device="0"
)

model.train(
    data="data.yaml",
    epochs=50,
    patience=10,
    batch=16,
    imgsz=640,
    device="0",
    workers=8,
    name="hexbug_v8s_tuned",
    optimizer="auto",
    seed=0,
    deterministic=True,
    close_mosaic=10,
    amp=True,
    overlap_mask=True,
    mask_ratio=4,
    dropout=0.0,
    val=True,
    split="val",
    iou=0.7,
    max_det=300,
    plots=True,
    augment=True,
    show_labels=True,
    show_conf=True,
    show_boxes=True,
    format="torchscript",
    simplify=True,
    lr0=0.005,
    lrf=0.2,
    momentum=0.937,
    weight_decay=0.0005,
    warmup_epochs=3.0,
    warmup_momentum=0.8,
    warmup_bias_lr=0.1,
    box=7.5,
    cls=0.5,
    dfl=1.5,
    pose=12.0,
    kobj=1.0,
    nbs=64,
    hsv_h=0.015,
    hsv_s=0.7,
    hsv_v=0.4,
    translate=0.1,
    scale=0.5,
    fliplr=0.5,
    mosaic=1.0,
    auto_augment="randaugment",
    erasing=0.4,
    tracker="botsort.yaml"
)